{
    "queries": [
        {
            "id": 1,
            "question": "Return the customer name and address as one field called fullAddress that consists of the address, city, state. Only show customers in 'IA' or 'BC' that have a valid address. Order by customer name ascending.",
            "query_string": "SELECT cname || ', ' || address || ', ' || city || ', ' || state AS fullAddress FROM customer WHERE state IN ('IA', 'BC') AND address IS NOT NULL ORDER BY cname ASC;",
            "type": "medium",
            "total_tokens": 618,
            "prompt_tokens": 574,
            "completion_tokens": 44,
            "total_cost": 0.001898,
            "time": 0.7979540824890137,
            "similarity": 0.9,
            "column_matching_index": 0.7,
            "result": true
        },
        {
            "id": 2,
            "question": "Return the shipment id, shipment date, product id, and amount for all shipments in 2022 where there was a product shipped with an amount greater than 8. Only show a shipment once and order by shipment date descending and amount descending.",
            "query_string": "SELECT s.sid, s.shipdate, sp.pid, sp.amount FROM shipment s JOIN shippedproduct sp ON s.sid = sp.sid WHERE s.shipdate >= TO_DATE('2022-01-01', 'YYYY-MM-DD') AND s.shipdate < TO_DATE('2023-01-01', 'YYYY-MM-DD') AND sp.amount > 8 ORDER BY s.shipdate DESC, sp.amount DESC;",
            "type": "medium",
            "total_tokens": 668,
            "prompt_tokens": 578,
            "completion_tokens": 90,
            "total_cost": 0.002094,
            "time": 2.002218008041382,
            "similarity": 0.9,
            "column_matching_index": 1,
            "result": true
        },
        {
            "id": 3,
            "question": "Find all customers that have an 'R' or 'T' in their name and have a state of 'MI' or 'IA'. Order by customer name descending.",
            "query_string": "SELECT cname, state FROM customer WHERE (cname LIKE '%R%' OR cname LIKE '%T%') AND (state = 'MI' OR state = 'IA') ORDER BY cname DESC;",
            "type": "simple",
            "total_tokens": 606,
            "prompt_tokens": 563,
            "completion_tokens": 43,
            "total_cost": 0.001861,
            "time": 0.8394169807434082,
            "similarity": 0.9,
            "column_matching_index": 0.9,
            "result": false
        },
        {
            "id": 4,
            "question": "Return a list of the unique product id and names that have shipped before with an amount less than 5 and order by product id descending.",
            "query_string": "SELECT DISTINCT sp.pid, p.pname  FROM shippedproduct sp  JOIN product p ON sp.pid = p.pid  WHERE sp.amount < 5  ORDER BY sp.pid DESC;",
            "type": "simple",
            "total_tokens": 597,
            "prompt_tokens": 557,
            "completion_tokens": 40,
            "total_cost": 0.0018310000000000002,
            "time": 0.6641819477081299,
            "similarity": 1,
            "column_matching_index": 1,
            "result": true
        },
        {
            "id": 5,
            "question": "For each state, return the number of customers in that state and the number of shipments for customers in that state. Only show states with at least 2 shipments. Order by number of shipments descending.",
            "query_string": "SELECT c.state, COUNT(DISTINCT c.cid) AS num_customers, COUNT(DISTINCT s.sid) AS num_shipments FROM customer c JOIN shipment s ON c.cid = s.cid GROUP BY c.state HAVING COUNT(DISTINCT s.sid) >= 2 ORDER BY num_shipments DESC;",
            "type": "medium",
            "total_tokens": 639,
            "prompt_tokens": 569,
            "completion_tokens": 70,
            "total_cost": 0.001987,
            "time": 1.211320161819458,
            "similarity": 1,
            "column_matching_index": 1,
            "result": true
        },
        {
            "id": 6,
            "question": "Return the top 3 products for state 'AB' based on shipment revenue (amount*price) for the year 2022.",
            "query_string": "SELECT p.pname, SUM(sp.amount * pr.price) AS revenue FROM product p JOIN shippedproduct sp ON p.pid = sp.pid JOIN shipment s ON sp.sid = s.sid JOIN customer c ON s.cid = c.cid WHERE c.state = 'AB' AND EXTRACT(YEAR FROM s.shipdate) = 2022 GROUP BY p.pname ORDER BY revenue DESC FETCH FIRST 3 ROWS ONLY;",
            "type": "complex",
            "total_tokens": 650,
            "prompt_tokens": 556,
            "completion_tokens": 94,
            "total_cost": 0.0020440000000000002,
            "time": 1.03031587600708,
            "similarity": 0.7,
            "column_matching_index": 0.8,
            "result": false
        },
        {
            "id": 7,
            "question": "Return a list of products (id and name) along with the number of times it has been shipped, the total amount of all shipments, and the total value of all shipments. Only consider shipments after September 1st, 2021, and only show products if they have been shipped at least three times and have a totalValueShipped > $110. Order by totalAmountShipped ascending.",
            "query_string": "SELECT sp.pid AS product_id,         p.pname AS product_name,         COUNT(sp.sid) AS times_shipped,         SUM(sp.amount) AS total_amount_shipped,         SUM(sp.amount * pr.price) AS total_value_shipped FROM shippedproduct sp JOIN product p ON sp.pid = p.pid JOIN shipment s ON sp.sid = s.sid JOIN product pr ON sp.pid = pr.pid WHERE s.shipdate > TO_DATE('2021-09-01', 'YYYY-MM-DD') GROUP BY sp.pid, p.pname HAVING COUNT(sp.sid) >= 3 AND SUM(sp.amount * pr.price) > 110 ORDER BY total_amount_shipped ASC;",
            "type": "complex",
            "total_tokens": 760,
            "prompt_tokens": 610,
            "completion_tokens": 150,
            "total_cost": 0.00243,
            "time": 1.5682780742645264,
            "similarity": 1,
            "column_matching_index": 1,
            "result": true
        },
        {
            "id": 8,
            "question": "Return pairs of customers (only show a pair once) that have been shipped the same product. Return the number of times the pair of customers have been shipped the same product (numShippedProducts). Order by numShippedProducts descending, then first customer name ascending, and second customer name ascending. Show customer pairs that have 5 or more times that they have been shipped the same product.",
            "query_string": "SQL Query to run: ```sql SELECT c1.cname AS customer1, c2.cname AS customer2, COUNT(sp1.pid) AS numShippedProducts FROM customer c1 JOIN shipment s1 ON c1.cid = s1.cid JOIN shippedproduct sp1 ON s1.sid = sp1.sid JOIN shippedproduct sp2 ON sp1.pid = sp2.pid AND sp1.sid <> sp2.sid JOIN shipment s2 ON sp2.sid = s2.sid JOIN customer c2 ON s2.cid = c2.cid GROUP BY c1.cname, c2.cname HAVING COUNT(sp1.pid) >= 5 ORDER BY numShippedProducts DESC, customer1 ASC, customer2 ASC; ```",
            "type": "complex",
            "total_tokens": 768,
            "prompt_tokens": 608,
            "completion_tokens": 160,
            "total_cost": 0.002464,
            "time": 1.8858551979064941,
            "similarity": 0.5,
            "column_matching_index": 0.8,
            "result": false
        },
        {
            "id": 9,
            "question": "Return a complete list of all customers (cid, cname), the total number of shipments, and total shipped value (amount*price) that they have been shipped. Return the bottom",
            "query_string": "SELECT c.cid, c.cname, COUNT(s.sid) AS total_shipments, SUM(sp.amount * p.price) AS total_shipped_value FROM customer c JOIN shipment s ON c.cid = s.cid JOIN shippedproduct sp ON s.sid = sp.sid JOIN product p ON sp.pid = p.pid GROUP BY c.cid, c.cname ORDER BY total_shipments, total_shipped_value Answer: The SQL query will return a complete list of all customers with their customer ID, name, the total number of shipments they have received, and the total value of all products they have been shipped. The results will be ordered from the bottom based on the total number of shipments and total shipped value.",
            "type": "complex",
            "total_tokens": 712,
            "prompt_tokens": 566,
            "completion_tokens": 146,
            "total_cost": 0.0022819999999999997,
            "time": 1.4791901111602783,
            "similarity": 0.5,
            "column_matching_index": 0.8,
            "result": false
        },
        {
            "id": 10,
            "question": "Return the products that are shipped more often than the average number of times a product is shipped. Order by number of shipments descending and product id ascending.",
            "query_string": "SELECT p.pid, p.pname, COUNT(sp.sid) AS num_shipments FROM product p JOIN shippedproduct sp ON p.pid = sp.pid GROUP BY p.pid, p.pname HAVING COUNT(sp.sid) > (SELECT AVG(ship_count) FROM (SELECT pid, COUNT(sid) AS ship_count FROM shippedproduct GROUP BY pid)) ORDER BY num_shipments DESC, p.pid ASC;",
            "type": "complex",
            "total_tokens": 645,
            "prompt_tokens": 559,
            "completion_tokens": 86,
            "total_cost": 0.0020210000000000002,
            "time": 1.580245018005371,
            "similarity": 1,
            "column_matching_index": 1,
            "result": true
        },
        {
            "id": 11,
            "question": "Return the product names, price, inventory, and inventory value of each product (`price*inventory`) (rename as `inventoryValue`) for products with price greater than `$20`. Order by product name ascending.",
            "query_string": "SELECT pname, price, inventory, price * inventory AS inventoryValue FROM product WHERE price > 20 ORDER BY pname ASC;",
            "type": "simple",
            "total_tokens": 599,
            "prompt_tokens": 571,
            "completion_tokens": 28,
            "total_cost": 0.0018249999999999998,
            "time": 0.6035661697387695,
            "similarity": 1,
            "column_matching_index": 1,
            "result": true
        },
        {
            "id": 12,
            "question": "Return the customer id, name, state, and shipment date for all customers in `'BC'` or `'IA'` that have had a shipment in `2022`. Order by `shipdate` descending and `cname` ascending.",
            "query_string": "SELECT c.cid, c.cname, c.state, s.shipdate FROM customer c JOIN shipment s ON c.cid = s.cid WHERE c.state IN ('BC', 'IA') AND s.shipdate >= TO_DATE('2022-01-01', 'YYYY-MM-DD') ORDER BY s.shipdate DESC, c.cname ASC;",
            "type": "medium",
            "total_tokens": 652,
            "prompt_tokens": 577,
            "completion_tokens": 75,
            "total_cost": 0.002031,
            "time": 1.0225379467010498,
            "similarity": 0.9,
            "column_matching_index": 1,
            "result": true
        },
        {
            "id": 13,
            "question": "Find all customers that either have the word `'street'` in their street address or have no street address. ",
            "query_string": "SELECT *  FROM customer WHERE address LIKE '%street%' OR address IS NULL;",
            "type": "simple",
            "total_tokens": 572,
            "prompt_tokens": 552,
            "completion_tokens": 20,
            "total_cost": 0.0017360000000000001,
            "time": 0.7633030414581299,
            "similarity": 0.7,
            "column_matching_index": 0.9,
            "result": false

        },
        {
            "id": 14,
            "question": "Return a list of the unique city and states of customers. Order output by `state` descending.",
            "query_string": "SELECT DISTINCT city, state FROM customer ORDER BY state DESC;",
            "type": "simple",
            "total_tokens": 566,
            "prompt_tokens": 549,
            "completion_tokens": 17,
            "total_cost": 0.0017150000000000002,
            "time": 0.592094898223877,
            "similarity": 1,
            "column_matching_index": 1,
            "result": true
        },
        {
            "id": 15,
            "question": "For each city, return the number of customers in that city and the number of shipments for customers in that city. **Hint: COUNT(DISTINCT *field*) may be useful.** Only show cities with at least 2 shipments. Order by number of shipments descending and city ascending.",
            "query_string": "SELECT c.city, COUNT(DISTINCT c.cid) AS num_customers, COUNT(DISTINCT s.sid) AS num_shipments FROM customer c JOIN shipment s ON c.cid = s.cid GROUP BY c.city HAVING COUNT(DISTINCT s.sid) >= 2 ORDER BY num_shipments DESC, c.city ASC;",
            "type": "medium",
            "total_tokens": 661,
            "prompt_tokens": 587,
            "completion_tokens": 74,
            "total_cost": 0.002057,
            "time": 0.8808610439300537,
            "similarity": 1,
            "column_matching_index": 1,
            "result": true
        },
        {
            "id": 16,
            "question": "Return the top 5 products for state `'BC'` based on shipment revenue (`amount*price`) for the year `2021`.",
            "query_string": "SELECT p.pname, SUM(sp.amount * pr.price) AS revenue FROM product p JOIN shippedproduct sp ON p.pid = sp.pid JOIN shipment s ON sp.sid = s.sid JOIN customer c ON s.cid = c.cid WHERE c.state = 'BC' AND EXTRACT(YEAR FROM s.shipdate) = 2021 GROUP BY p.pname ORDER BY revenue DESC;",
            "type": "medium",
            "total_tokens": 643,
            "prompt_tokens": 557,
            "completion_tokens": 86,
            "total_cost": 0.0020150000000000003,
            "time": 1.0019481182098389,
            "similarity": 0.7,
            "column_matching_index": 0.8,
            "result": false
        },
        {
            "id": 17,
            "question": "Return a list of products (id and name) along with the number of times it has been shipped, the total amount of all shipments, and the total value of all shipments. Only consider shipments after `March 10th, 2022`, and only show products if they have been shipped at least twice. Order by `totalValueShipped` descending.",
            "query_string": "SELECT sp.pid AS product_id, pr.pname AS product_name, COUNT(sp.sid) AS times_shipped, SUM(sp.amount) AS total_shipments, SUM(sp.amount * pr.price) AS totalValueShipped FROM shippedproduct sp JOIN product pr ON sp.pid = pr.pid JOIN shipment s ON sp.sid = s.sid WHERE s.shipdate > TO_DATE('2022-03-10', 'YYYY-MM-DD') GROUP BY sp.pid, pr.pname HAVING COUNT(sp.sid) >= 2 ORDER BY totalValueShipped DESC;",
            "type": "complex",
            "total_tokens": 722,
            "prompt_tokens": 602,
            "completion_tokens": 120,
            "total_cost": 0.002286,
            "time": 1.783141851425171,
            "similarity": 1,
            "column_matching_index": 1,
            "result": true
        },
        {
            "id": 18,
            "question": "Return pairs of products (only show a pair once) that appear together in the same shipment and have at least an `amount` of 2 in that shipment. Return the number of times the products appear together in a shipment ('numTogether'). Order by `numTogether` descending, then first product name ascending, and second product name ascending.",
            "query_string": "```sql SELECT sp1.pid AS product1_id, p1.pname AS product1_name, sp2.pid AS product2_id, p2.pname AS product2_name, COUNT(*) AS numTogether FROM shippedproduct sp1 JOIN shippedproduct sp2 ON sp1.sid = sp2.sid AND sp1.pid < sp2.pid JOIN product p1 ON sp1.pid = p1.pid JOIN product p2 ON sp2.pid = p2.pid WHERE sp1.amount >= 2 AND sp2.amount >= 2 GROUP BY sp1.pid, p1.pname, sp2.pid, p2.pname ORDER BY numTogether DESC, p1.pname ASC, p2.pname ASC; ```",
            "type": "complex",
            "total_tokens": 754,
            "prompt_tokens": 598,
            "completion_tokens": 156,
            "total_cost": 0.002418,
            "time": 1.5578181743621826,
            "similarity": 0.7,
            "column_matching_index": 0.8,
            "result": false
        },
        {
            "id": 19,
            "question": "Return a complete list of  products (`pid`, `pname`), the total number of shipments, and total shipped amount that they have been shipped to customers in `'IA'`.",
            "query_string": "SELECT p.pid, p.pname, COUNT(sp.sid) AS total_shipments, SUM(sp.amount) AS total_shipped_amount FROM product p JOIN shippedproduct sp ON p.pid = sp.pid JOIN shipment s ON sp.sid = s.sid JOIN customer c ON s.cid = c.cid WHERE c.state = 'IA' GROUP BY p.pid, p.pname ORDER BY total_shipments DESC;",
            "type": "complex",
            "total_tokens": 653,
            "prompt_tokens": 565,
            "completion_tokens": 88,
            "total_cost": 0.0020469999999999998,
            "time": 1.289525032043457,
            "similarity": 0.7,
            "column_matching_index": 1,
            "result": false

        },
        {
            "id": 20,
            "question": "Return the customers who have more shipments than the average number of shipments per customer.",
            "query_string": "SELECT c.cid, c.cname, COUNT(s.sid) AS num_shipments FROM customer c JOIN shipment s ON c.cid = s.cid GROUP BY c.cid, c.cname HAVING COUNT(s.sid) > (SELECT AVG(ship_count) FROM (SELECT cid, COUNT(sid) AS ship_count FROM shipment GROUP BY cid)) ORDER BY num_shipments DESC;",
            "type": "complex",
            "total_tokens": 625,
            "prompt_tokens": 545,
            "completion_tokens": 80,
            "total_cost": 0.001955,
            "time": 0.9953117370605469,
            "similarity": 1,
            "column_matching_index": 1,
            "result": true
        }
    ]
}